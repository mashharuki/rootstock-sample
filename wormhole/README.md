# Wormhole 入門

急速に進化するブロックチェーン技術の分野において、異なるブロックチェーン間の相互運用性は大きな課題となっています。開発者は複数のブロックチェーンでシームレスに動作するアプリケーションの開発に困難を抱えており、これがイノベーションや分散型エコシステムの可能性を制約しています。

Wormhole は、この問題に対応するため、異なるブロックチェーン間での安全かつ効率的な通信を可能にする一般的なメッセージ送信プロトコルを提供します。これにより、データや資産の転送が様々なブロックチェーンネットワーク間で行えるようになり、これまで孤立していたエコシステム間の壁を取り除きます。

Wormhole の特徴は、堅牢なセキュリティ、スケーラビリティ、透明性への重点にあります。このプロトコルは、分散型のバリデータネットワークによりサポートされており、すべてのクロスチェーン取引の完全性が保証されています。また、Wormhole は実際のアプリケーションでの実績により、開発者が安心してマルチチェーンアプリケーションを構築・拡張できる信頼性のあるプラットフォームを提供します。

Wormhole は、開発者が複数のブロックチェーンエコシステムの強みを活用しながら、1 つのエコシステムに縛られることなくアプリケーションを作成できるようにします。これにより、アプリケーションは Solana の高スループット、Ethereum のセキュリティ、Cosmos の相互運用性といった様々なネットワークの特性を活かしつつ、統一された効率的なユーザー体験を提供することが可能です。

このページでは、Wormhole がどのように高速で安全、かつスケーラブルなクロスチェーン通信を実現しているかを理解するための主要な概念や構成要素について紹介します。

---

## Wormhole が解決する課題

ブロックチェーンの急速な発展において、相互運用性は重要な課題です。多くのブロックチェーンは孤立しており、複数のエコシステムにまたがる統合アプリケーションの可能性を制限しています。Wormhole は、ブロックチェーン間のシームレスな通信を可能にし、開発者が各ネットワークの特有の特徴を活用できるマルチチェーンアプリケーションを構築できるようにします。

Wormhole が解決する主な課題には以下が含まれます：

- **ブロックチェーンの孤立** - Wormhole は異なるブロックチェーンを接続し、資産、データ、ガバナンスのアクションをネットワーク間で転送可能にします。
- **クロスチェーンの複雑さ** - Wormhole はクロスチェーン通信の複雑さを抽象化し、開発者がクロスチェーンアプリケーションを構築・展開しやすくします。
- **セキュリティと分散化** - Wormhole は、分散型の Guardian ネットワークによってメッセージを検証・署名し、クロスチェーンインタラクションの完全性を保証します。

---

## Wormhole の提供する機能

Wormhole は、幅広いユースケースをサポートするツールとプロトコルのスイートを提供します：

- **クロスチェーンメッセージング** - 任意のデータを安全にブロックチェーン間で転送し、クロスチェーン分散型アプリケーション（xDapps）の開発を可能にします。
- **資産の転送** - Wormhole 上の Portal などのプロトコルを通じて、サポートされているチェーン間でトークンや NFT を簡単に移動させることができます。
- **開発者向けツール** - Wormhole の SDK、API、Wormhole Scan、およびドキュメントを活用し、クロスチェーンアプリケーションの迅速な構築と展開が可能です。

---

## Wormhole ではないもの

- **ブロックチェーンではない** - Wormhole は異なるブロックチェーンをつなぐ通信レイヤーとして機能し、ブロックチェーンそのものではありません。
- **トークンブリッジではない** - Wormhole はトークン転送をサポートしていますが、それに限らず、幅広いクロスチェーンアプリケーションをサポートするため、通常のブリッジよりも汎用性があります。

---

## Wormhole のユースケース

Wormhole によって実現可能なアプリケーションの例を以下に示します：

- **クロスチェーンエクスチェンジ** - Wormhole Connect を使用して、あらゆる Wormhole 対応チェーンからの預金を可能にするエクスチェンジを構築し、流動性へのアクセスを大幅に増やすことができます。
- **クロスチェーンガバナンス** - 異なるネットワークの NFT コレクションは、各チェーンで投票された票を指定の「投票チェーン」に送信し、統合された提案を行うことができます。
- **クロスチェーンゲーム** - 高性能なネットワーク（例：Solana）上でゲームを開発し、別のネットワーク（例：Ethereum）で NFT として報酬を発行することが可能です。

---

## 詳細を探る

Wormhole エコシステム、コンポーネント、プロトコルについてさらに学びましょう：

- **アーキテクチャ** - プロトコルのコンポーネントを詳しく探る
- **プロトコル仕様** - Wormhole 上に構築されたプロトコルについて学ぶ

---

## デモ

チュートリアルよりも現実的な実装を提供します：

- **Wormhole Scaffolding** - Scaffolding リポジトリを使用して素早くプロジェクトをセットアップ
- **xDapp Book Projects** - 実例プログラムを実行し、学ぶことができます

さらに多くのデモはデモページで利用可能です。

---

## 注意

### Wormhole の統合は完了しましたか？

完了した場合、私たちにお知らせください！エコシステムディレクトリにあなたのプロジェクトを掲載し、グローバルでマルチチェーンのコミュニティに紹介します。

今すぐご連絡ください！

---

## サポートされているブロックチェーン

Wormhole はサポートするブロックチェーンの数を増やし続けています。

- Acala
- Algorand
- Aptos
- Arbitrum
- Avalanche
- Base
- Berachain
- Blast
- BNB Smart Chain
- Celestia
- Celo
- Cosmoshub
- Dymension
- Ethereum
- Evmos
- Fantom
- Gnosis
- Injective
- Karura
- Kaia
- Kujira
- Linea
- Mantle
- Moonbeam
- NEAR
- Neon
- Neutron
- Oasis
- Optimism
- Osmosis
- Polygon
- Provenance
- Pythnet
- Rootstock
- Scroll
- Seda
- Sei
- Seievm
- SNAXchain
- Solana
- Stargaze
- Sui
- Terra
- Terra2
- Xlayer
- Xpla

# Cross-Chain コントラクトの作成

## はじめに

Wormhole のクロスチェーンメッセージング機能を利用すると、スマートコントラクトが複数のブロックチェーン間でシームレスにやり取りできます。これにより、Avalanche、Celo、Ethereum など、さまざまなネットワークの利点を活かした分散型アプリケーションを構築することが可能です。このチュートリアルでは、Wormhole の Solidity SDK を使って、チェーン間でメッセージを送受信するクロスチェーンコントラクトの作成方法を紹介します。

Wormhole のメッセージングインフラストラクチャは、ブロックチェーン間のデータ送信、イベントのトリガー、トランザクションの開始を簡単にします。このチュートリアルでは、Avalanche Fuji と Celo Alfajores の 2 つのテストネットにコントラクトをデプロイし、チェーン間でメッセージを送信する実践的なデモを通じて、この機能を解説します。

チュートリアル終了時には、Solidity を使用してクロスチェーンメッセージの送受信を行う機能を備えたコントラクトを構築し、Wormhole のリレイヤーを活用してクロスチェーンコストを管理し、送信元と受信先チェーンでのスマートコントラクト設定が適切であることを確認する方法を理解できるようになります。

なお、このチュートリアルでは Solidity とスマートコントラクト開発の基礎知識が前提です。Wormhole プロトコルの基本について理解を深めておくとよりスムーズに進められます。

## Wormhole 概要

本チュートリアルでは、主に Wormhole のリレイヤーと Wormhole コアコントラクトの 2 つの主要コンポーネントと対話します。リレイヤーはクロスチェーンメッセージの配信を担当し、メッセージが正確にターゲットチェーンで受信されるようにします。この機能により、開発者が複雑な処理を気にすることなく、スマートコントラクトがブロックチェーンを越えて通信できます。

さらに、Wormhole リレイヤーはクロスチェーントランザクションのコストを自動的に計算し、支払いを円滑にします。この機能により、ターゲットチェーンとメッセージを指定するだけで、適切な料金でメッセージが送信されます。

### 必要条件

このチュートリアルを始める前に、以下の準備を確認してください：

- Node.js と npm のインストール
- コントラクトデプロイ用の Foundry
- Avalanche-Fuji と Celo-Alfajores のテストネットトークン（ガス代用）
- ウォレットのプライベートキー

## クロスチェーンメッセージングコントラクトの構築

このセクションでは、Avalanche Fuji から Celo Alfajores にメッセージを送信するためのコントラクトと、メッセージを受信するコントラクトをデプロイします。

### 送信者コントラクト: MessageSender

MessageSender コントラクトは、クロスチェーンメッセージのコストを見積もり、メッセージを送信する役割を担います。

- `quoteCrossChainCost` - Wormhole リレイヤーを使用してターゲットチェーンへのメッセージ配信コストを計算
- `sendMessage` - メッセージをエンコードし、ターゲットチェーンのコントラクトアドレスに送信

以下はコントラクトの主要部分です：

```solidity
function sendMessage(
    uint16 targetChain,
    address targetAddress,
    string memory message
) external payable {
    uint256 cost = quoteCrossChainCost(targetChain);

    require(
        msg.value >= cost,
        "Insufficient funds for cross-chain delivery"
    );

    wormholeRelayer.sendPayloadToEvm{value: cost}(
        targetChain,
        targetAddress,
        abi.encode(message, msg.sender),
        0,
        GAS_LIMIT
    );
}
```

## 受信者コントラクト: MessageReceiver

MessageReceiver コントラクトは、受信したクロスチェーンメッセージを処理し、メッセージの内容をログに記録します。信頼できるコントラクトのみがメッセージを送信・処理できるようにし、セキュリティを強化しています。

## エミッターの検証と登録

クロスチェーンメッセージングでは、送信者の検証が不可欠です。isRegisteredSender 修飾子により、登録されたコントラクトからのメッセージのみが処理され、悪意のあるメッセージを防ぎます。

## メッセージ処理

receiveWormholeMessages 関数は、受信したメッセージを処理する主要な関数です。メッセージが Wormhole リレイヤーによって送信されたことを確認し、ペイロードをデコードしてメッセージ内容を記録します。

```solidity
function receiveWormholeMessages(
    bytes memory payload,
    bytes[] memory,
    bytes32 sourceAddress,
    uint16 sourceChain,
    bytes32
) public payable override isRegisteredSender(sourceChain, sourceAddress) {
    require(
        msg.sender == address(wormholeRelayer),
        "Only the Wormhole relayer can call this function"
    );

    string memory message = abi.decode(payload, (string));

    if (sourceChain != 0) {
        emit SourceChainLogged(sourceChain);
    }

    emit MessageReceived(message);
}
```

### 参考文献

1. [Introduction to Wormhole](https://wormhole.com/docs/learn/fundamentals/introduction/)
2. [Transfer USDC via CCTP and Wormhole SDK](https://wormhole.com/docs/tutorials/messaging/cctp/)
3. [Create Cross-Chain Contracts](https://wormhole.com/docs/tutorials/messaging/cross-chain-contracts/)
4. [GitHub - wormhole-scaffolding](https://github.com/wormhole-foundation/wormhole-scaffolding)
5. [GitHub - wormhole-examples](https://github.com/wormhole-foundation/wormhole-examples)
6. [GitHub - wormhole-demo-wormhole-messaging](https://github.com/wormhole-foundation/demo-wormhole-messaging)
7. [Contract Address 情報](https://wormhole.com/docs/build/reference/contract-addresses/#__tabbed_1_2)
8. [GitHub - wormhole-foundation/demo-tutorials](https://github.com/wormhole-foundation/demo-tutorials)
